{% extends 'layouts/class_teacher_main.html' %}

{% block title %} Student Management System {% endblock title %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
    
{% endblock stylesheets %}

{% block content %}
<body>
    
</body>
<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="col-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title"><a href="/view-std-detail/{{ sub_teacher.student_id }} " style="text-decoration: none;"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-return-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z"/>
                          </svg>Back </a>/ Individual Student Assesment</h4>
                        <hr>

                        <div class="pos-rel">
                            <!-- Nav pills -->
                            <ul class="nav nav-pills justify-content-center nav-justified" role="tablist">
                                <li class="nav-item">
                                    <hr class="horizontal2"/>
                                    <a class="nav-link active btn btn-primary" data-toggle="pill"
                                        href="#studentDetail">Student Detail</a>
                                </li>
                                <li class="nav-item">
                                    <hr class="horizontal2"/>
                                    <a class="nav-link btn btn-primary" data-toggle="pill" href="#marks_std">Student
                                        Marks</a>
                                <li class="nav-item">
                                    <a class="nav-link btn btn-primary" data-toggle="pill" href="#teacher_remarks">Teacher
                                        Remarks</a>
                                </li>
                                </li>

                            </ul>
                            <div class="connected-line"></div>

                            <div class="tab-content">
                                <div id="studentDetail" class="container tab-pane active">
                                    <div class="container mt-0">
                                        <div class="row d-flex justify-content-center">
                                            <div class="col-md-7">
                                                <div class="card p-3 py-4">
                                                    <div class="text-center">
                                                        <a href="{{ sub_teacher.half_photo }}" class="image-popup"
                                                            title="Passport Size Photo">
                                                            <img src="{{ sub_teacher.half_photo }}" width="150px"
                                                                height="140px" class="rounded-circle">
                                                        </a>
                                                    </div>
                                                    <div class="text-center mt-3">
                                                        <span class="bg-secondary p-1 px-4 rounded text-white">
                                                           {{sub_teacher.first_name}} {{sub_teacher.last_name}}
                                                           <input type="hidden" id="std_id" value="{{sub_teacher.student_id}}"></span>
                                                        <div class="px-4 mt-1"> <br>
                                                            <p><b>Subject Teacher:</b> {{sub_teacher.username}}</p>
                                                            <p><b>Subject:</b> {{sub_teacher.subject}}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div id="marks_std" class="container tab-pane fade">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="table-responsive">
                                                <table class="table align-items-center table-flush" id="customerList" style="width:100%;">
                                                    <thead class="thead-light">
                                                        <tr>
                                                            <th scope="col" class="sort" data-sort="name">Subject
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">class test
                                                                I
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="budget">Mid-term
                                                                Exam</th>
                                                            <th scope="col" class="sort" data-sort="name">Class test
                                                                II
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">Annual
                                                                Exam
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">CA</th>
                                                            <th scope="col" class="sort" data-sort="name">Total</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="list">

                                                        {% for usr in user %}

                                                        <tr>
                                                            <th scope="row">
                                                                {{ usr.subject }}
                                                            </th>
                                                            <th scope="row">
                                                                {{ usr.class_test_one }}
                                                            </th>
                                                            <td class="budget">
                                                                {{ usr.mid_term}}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.class_test_two}}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.annual_exam }}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.cont_assessment }}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.total }}
                                                            </td>

                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Table Display -->
                                <div id="teacher_remarks" class="container tab-pane fade">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>sl</th>
                                                <th>Personal Qualities</th>
                                                <th>Rating</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>1</td>
                                                <td>Punctuality</td>
                                                <td>{{sub_teacher.punctuality}}</td>
                                                
                                            </tr>
                                            <tr>
                                                <td>2</td>
                                                <td>Discipline</td>
                                                <td>{{sub_teacher.discipline}}</td>
                                            </tr>
                                            <tr>
                                                <td>3</td>
                                                <td>Social Service</td>
                                                <td>{{sub_teacher.social_service}}</td>
                                            </tr> 
                                            <tr>
                                                <td>4</td>
                                                <td>Leadership Quality</td>
                                                <td> {{sub_teacher.leadership_quality}}</td>
                                                
                                            </tr>
                                            <tr>
                                                <td>5</td>
                                                <td>Supw Grade</td>
                                                <td> {{sub_teacher.supw_grade}}</td>
                                                
                                            </tr>
                                            <tr>
                                                <td>6</td>
                                                <td>Status</td>
                                                <td> {{sub_teacher.status_remarks}}</td>              
                                            </tr>                                       
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
     $(document).ready(function () {
    $('a[href="#marks_std"]').on('click', function () {
        var id=$('#std_id').val();
        loadUsers(id)
    });
});
    function loadUsers(id) {
        $('#customerList').DataTable({
            'processing': true,
            'serverSide': true,
            'bDestroy': true,
            'serverMethod': 'POST',
            'ajax': {
                'url': '/get-subject-marks/'+id
            },
        
            'columns': [
                { data: 'subject' },
                { data: 'class_test_one' },
                { data: 'mid_term' },
                { data: 'class_test_two' },
                { data: 'annual_exam' },
                { data: 'cont_assessment' },
                { data: 'total' }
            ],
            language: {
                paginate: {
                    next: '&#8594;', // or '→'
                    previous: '&#8592;' // or '←' 
                }
            },
            "ordering": false
        });
    }
    // ==========================================


    $("#action").on('change', function () {
        if (this.value == '') {
            $("#action").addClass('is-invalid')
        } else {
            $("#action").removeClass('is-invalid')
            $("#action").addClass('is-valid')
        }
    });

    $("#update").on('click', function () {
        if ($("#action").val() == '') {
            $("#action").addClass('is-invalid')
        } else {
            var form_data = new FormData($('#update_form')[0])
            $.ajax({
                type: "POST",
                url: "/update-status",
                data: form_data,
                dataType: "json",
                contentType: false,
                cache: false,
                processData: false,
                beforeSend: function () {
                    $("#update").text("Loading....")
                    $("#update").attr("disabled", true)
                    $("#update").addClass("disabled")

                },
                success: function (data) {
                    swal('Success', 'Application status updated successfully', 'success').then(function () {
                        window.location = '/admin-student-application-list'
                    })
                },
                error: function () {
                    swal('Success', 'Application status updated successfully', 'success').then(function () {
                        window.location = '/admin-student-application-list'
                    })
                }
            });
        }
    });
</script>

{% endblock javascripts %}